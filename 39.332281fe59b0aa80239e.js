"use strict";(self.webpackChunkproducts_alpha_ecosystem=self.webpackChunkproducts_alpha_ecosystem||[]).push([[39],{3916:(e,n,t)=>{t.d(n,{s:()=>a});var r=t(4848);var a=function(e){var n=e.className,t=void 0===n?"":n,a=e.children;return(0,r.jsx)("h2",{className:"".concat("H6YUf46Z"," ").concat(t),children:a})}},5039:(e,n,t)=>{t.r(n),t.d(n,{default:()=>D});var r=t(4848),a=t(6540),i=t(1468),c=t(181),o=t(7852),s=t(4247),u=t(6762);var l=function(e){var n=e.className,t=void 0===n?"":n,i=e.data,l=e.isFavorite,d=void 0!==l&&l,f=e.onFavoriteHandler,v=void 0===f?function(){}:f,h=e.onDeleteHandler,p=void 0===h?function(){}:h,x=(0,a.useState)(d),g=x[0],j=x[1],m=(0,c.Zp)(),C=i.description.length<=200?i.description:i.description.slice(0,200)+"…";return(0,r.jsxs)("li",{className:"".concat("vFnqvPE7"," ").concat(t),onClick:function(){m("/products/".concat(i.id))},children:[(0,r.jsx)("img",{src:i.category.image?i.category.image:"https://metallps.ru/assets/cache_image/empty_720x540_e0a.png",width:100,height:100,alt:"Изображение товара."}),(0,r.jsxs)("div",{className:"D1d5OPK3",children:[(0,r.jsxs)("div",{className:"iZSwgLsz",children:[(0,r.jsx)("h3",{children:i.title}),(0,r.jsxs)("div",{children:[i.price," ₽"]})]}),(0,r.jsx)("p",{children:C})]}),(0,r.jsxs)("div",{className:"VwTouOff",children:[(0,r.jsx)("button",{onClick:function(e){return function(e){e.stopPropagation(),p()}(e)},children:(0,r.jsx)(o.A,{})}),(0,r.jsx)("button",{onClick:function(e){return function(e){e.stopPropagation(),j(!g),v()}(e)},children:g?(0,r.jsx)(s.A,{}):(0,r.jsx)(u.A,{})})]})]})};var d=function(e){var n=e.className,t=void 0===n?"":n,a=e.list,i=void 0===a?[]:a,c=e.favorites,o=void 0===c?[]:c,s=e.onDelete,u=void 0===s?function(){}:s,d=e.addFavorite,f=void 0===d?function(){}:d,v=e.removeFavorite,h=void 0===v?function(){}:v,p=function(e){return o.some((function(n){return n.id===e}))};return(0,r.jsx)("ul",{className:"".concat("EYZJGCQZ"," ").concat(t),children:i.map((function(e){return(0,r.jsx)(l,{data:e,isFavorite:p(e.id),onDeleteHandler:function(){return n=e.id,u(n),void h(n);var n},onFavoriteHandler:p(e.id)?function(){return h(e.id)}:function(){return f(e)}},e.id)}))})},f=t(4566),v=t(3497),h=t(3344),p=t(1112),x=t(8651);var g=function(e){var n=e.className,t=void 0===n?"":n,i=e.favoritesOnChange,c=e.searchOnChange,o=e.onSortChange,s=(0,a.useState)(""),u=s[0],l=s[1],d=(0,a.useRef)(null);return(0,r.jsxs)("div",{className:"".concat("CUXGusvB"," ").concat(t),children:[(0,r.jsx)(v.A,{onChange:i,children:"Show favorites"}),(0,r.jsx)(h.A,{className:"h6VduQmc",value:u,onChange:function(e){var n=e.target.value;l(n),d.current&&clearTimeout(d.current),d.current=setTimeout((function(){c(n)}),500)},placeholder:"Search products"}),(0,r.jsxs)(p.A,{className:"yMAu3lFp",defaultValue:x.x.DEFAULT,onChange:o,children:[(0,r.jsx)(p.A.Option,{value:x.x.DEFAULT,children:"Default"}),(0,r.jsx)(p.A.Option,{value:x.x.ASCENDING,children:"Low to High"}),(0,r.jsx)(p.A.Option,{value:x.x.DESCENDING,children:"High to Low"})]})]})},j=t(3916),m=t(329),C=t(8e3);var N=function(e){var n=e.className,t=void 0===n?"":n,a=e.prevPage,i=void 0===a?function(){}:a,c=e.nextPage,o=void 0===c?function(){}:c,s=e.current,u=void 0===s?1:s,l=e.hasMore,d=void 0===l||l;return(0,r.jsxs)("div",{className:"".concat("GPfq2Nn7"," ").concat(t),children:["Page",(0,r.jsx)("button",{onClick:i,disabled:1===u,children:(0,r.jsx)(m.A,{})}),(0,r.jsx)("p",{children:u}),(0,r.jsx)("button",{onClick:o,disabled:!d,children:(0,r.jsx)(C.A,{})})]})},A=t(1576),S=function(e){return e.favorites.favorites},F=t(4185);const D=function(){var e=(0,i.wA)(),n=(0,i.d4)(S),t=(0,F.TZ)()[0],o=(0,c.zy)(),s=(0,c.Zp)(),u=(0,a.useState)(1),l=u[0],v=u[1],h=(0,a.useState)(1),p=h[0],m=h[1],C=(0,a.useState)(""),D=C[0],w=C[1],E=(0,a.useState)(!0),P=E[0],y=E[1],L=(0,a.useState)(x.x.DEFAULT),k=L[0],O=L[1],b=(0,a.useState)(!1),G=b[0],M=b[1];(0,a.useEffect)((function(){var e=new URLSearchParams(o.search).get("page");e&&v(+e)}),[o.search]);var H=(0,F.d$)({offset:(l-1)*F.re,limit:F.re,title:D}),T=H.data,Z=H.error,_=H.isLoading,U=H.isFetching;(0,a.useEffect)((function(){T&&T.length<F.re?y(!1):T&&T.length===F.re&&y(!0)}),[T]);var I=(0,a.useMemo)((function(){if(G){var e=n;D&&(m(1),e=e.filter((function(e){return e.title.toLowerCase().includes(D.toLowerCase())})));var t=(p-1)*F.re,r=p*F.re;return e.slice(t,r)}return T}),[n,T,G,p,D]),V=(0,a.useMemo)((function(){return I?function(e,n,t){if(t||2===arguments.length)for(var r,a=0,i=n.length;a<i;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))}([],I,!0).sort((function(e,n){switch(k){case x.x.ASCENDING:return e.price-n.price;case x.x.DESCENDING:return n.price-e.price;default:return 0}})):[]}),[I,k]);return(0,r.jsxs)("div",{children:[(0,r.jsx)(j.s,{children:"products"}),(0,r.jsx)(g,{favoritesOnChange:function(){return M(!G)},searchOnChange:function(e){w((function(){return s("/products?page=".concat(1)),e}))},onSortChange:function(e){return O(e)}}),(_||U)&&(0,r.jsx)(f.a,{}),!_&&Z&&(0,r.jsx)("p",{children:"Произошла ошибка, пожалуйста обновите страницу"}),_||U||Z||!V||!V.length?null:(0,r.jsxs)(r.Fragment,{children:[!G&&(0,r.jsx)(N,{prevPage:function(){v((function(e){var n=Math.max(e-1,1);return s("/products?page=".concat(n)),n}))},nextPage:function(){v((function(e){var n=e+1;return s("/products?page=".concat(n)),n}))},current:l,hasMore:P}),G&&(0,r.jsx)(N,{prevPage:function(){m((function(e){return Math.max(e-1,1)}))},nextPage:function(){m((function(e){return e+1}))},current:p,hasMore:V.length===F.re}),(0,r.jsx)(d,{list:V,favorites:n,onDelete:t,addFavorite:function(n){e((0,A.Gm)(n))},removeFavorite:function(n){e((0,A.Fy)(n))}})]}),V&&0===V.length&&(0,r.jsx)("p",{children:"По вашему запросу товаров не найдено"})]})}}}]);